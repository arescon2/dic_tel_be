var R4=Object.defineProperty,T4=Object.defineProperties;var M4=Object.getOwnPropertyDescriptors;var D4=Object.getOwnPropertySymbols;var Y4=Object.prototype.hasOwnProperty,V4=Object.prototype.propertyIsEnumerable;var y4=(t,n,a)=>n in t?R4(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,M=(t,n)=>{for(var a in n||(n={}))Y4.call(n,a)&&y4(t,a,n[a]);if(D4)for(var a of D4(n))V4.call(n,a)&&y4(t,a,n[a]);return t},K=(t,n)=>T4(t,M4(n));import{c as n4,_ as A,a as U4,u as v,b as O,d as P,j as c,e as u,B as C,F as k,f as A4,g as q4,h as J4,D as G,i as G4,M as W,T as Y,n as N,L as J,H as _4,k as L,r as y,R as b,C as r,I as F,A as j4,E as K4,l as R,P as T,m as a4,Q as s4,o as $,p as l4,q as w,s as f,S as H,t as H4,v as Q,w as g4,x as v4,y as X,z as p4,G as E4,J as Z,K as Q4,N as C4,O as W4,U as X4,V as Z4,W as uu,X as eu,Y as tu,Z as B4,$ as z4,a0 as q,a1 as nu,a2 as au,a3 as su,a4 as lu,a5 as ru,a6 as iu,a7 as ou,a8 as cu,a9 as du,aa as hu,ab as mu,ac as pu,ad as gu,ae as Eu,af as fu,ag as Du,ah as yu}from"./vendor.48760a86.js";const Cu=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function a(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=a(i);fetch(i.href,s)}};Cu();const Bu={loadingGlobal:!0,mainMenu:[],logined:!1,user:{}},L4=n4({name:"main_store",initialState:Bu,reducers:{setMainMenu:(t,n)=>{t.mainMenu=[...n.payload]},setLogined:(t,n)=>{let a=n.payload,o={};A.isObject(n.payload)&&(a=n.payload.status,o=n.payload.user),t.logined=a,t.user=o},setLoading:(t,n)=>{t.loadingGlobal=n.payload},setPageTitle:(t,n)=>{t.pageTitle=n.payload}}}),{setMainMenu:r0,setLogined:u4,setLoading:O4,setPageTitle:i0}=L4.actions;var wu=L4.reducer;const r4=U4.create({baseURL:"http://192.168.6.88:3000/",timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json"}}),I=async function(t,n){try{return await r4.get(t,{params:n||{}})}catch(a){throw new Error(a)}},V=async function(t,n={},a={}){return new Promise((o,i)=>{r4.post(t,n,{params:a}).then(s=>{o(s.data,s)}).catch(s=>{let l=s.response.data;A.isArray(l.message)&&(l.message=l.message.map(m=>m)),i(l,s.response)})})},_=async function(t,n={},a={}){return new Promise((o,i)=>{r4.put(t,n,{params:a}).then(s=>{o(s.data,s)}).catch(s=>{let l=s.response.data;A.isArray(l.message)&&(l.message=l.message.map(m=>m)),i(s.response.data,s.response)})})},i4=async function(t,n={},a={}){return new Promise((o,i)=>{r4.delete(t,{data:n,params:a}).then(s=>{o(s.data,s)}).catch(s=>{let l=s.response.data;A.isArray(l.message)&&(l.message=l.message.map(m=>m)),i(s.response.data,s.response)})})},Su=t=>A.filter(t,a=>a.name==="DEVELOP").length>0,bu=()=>{v(s=>s.main);const t=O(),n=P();return c("div",{className:"header-block",children:[u(C,{onClick:()=>{t("/tickets/new")},icon:u(k,{icon:A4}),type:"text"}),c("div",{className:"user-block",children:[u(C,{icon:u(k,{icon:q4}),type:"text",onClick:()=>t("/user-cabinet")}),u(C,{icon:u(k,{icon:J4}),type:"text"}),u(G,{type:"vertical"}),u(C,{icon:u(k,{icon:G4}),type:"text",danger:!0,onClick:()=>{V("/auth/logout").then(()=>{t("/login"),n(u4(!1))})}})]})]})},Fu=()=>{v(i=>i.main.user);const t=[{id:1,icon:"home",title:"\u0413\u043B\u0430\u0432\u043D\u0430\u044F \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430",placeholder:"\u0413\u043B\u0430\u0432\u043D\u0430\u044F \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430",roles:["ALL"],link:"/"},{id:2,icon:"address-book",title:"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u043A\u043E\u043D\u0442\u0430\u043A\u0442\u043D\u044B\u0439",placeholder:"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u043A\u043E\u043D\u0442\u0430\u043A\u0442\u043D\u044B\u0439",roles:["ALL"],link:"/dictionary"},{id:3,icon:"clipboard-list",title:"\u0422\u0438\u043A\u0435\u0442\u044B",placeholder:"\u0422\u0438\u043A\u0435\u0442\u044B",roles:["DEVELOP"],link:"/tickets"},{id:999,icon:"cog",title:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",placeholder:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",roles:["DEVELOP"],link:"/settings"}],n=O(),a=i=>{n(i.link)};return u("div",{className:"left-block",children:u(W,{className:"root-menu",defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],mode:"vertical",children:(()=>t.map(i=>u(W.Item,{style:{paddingLeft:"none"},placeholder:i.placeholder,onClick:()=>a(i),children:u(Y,{placement:"right",title:i.title,children:u(k,{style:{width:"100%"},size:"lg",icon:i.icon})})},N())))()})})};const xu=t=>c(J,{className:"rootLayout",children:[c(_4,{children:[u("meta",{charSet:"utf-8"}),u("title",{children:"AllTum.\u0416\u0443\u0440\u043D\u0430\u043B"})]},N()),u(Fu,{},N()),c("div",{className:"card-root-block",children:[u(bu,{}),u(J.Content,{className:"body-block",children:t.children})]},N())]});const ku=()=>u(L,{children:u("div",{className:"content",children:c("div",{className:"loading",children:[u("p",{children:"loading"}),u("span",{})]})})});const Au=()=>{const t=O(),n=P(),{logined:a}=v(g=>g.main),[o,i]=y.exports.useState(""),[s,l]=y.exports.useState(""),[m,E]=y.exports.useState([]),B=g=>{g.charCode===13&&d()},d=()=>{V("/auth/login",{login:o,password:s}).then(g=>{t("/"),n(u4({status:!0,user:g.data})),n(O4(!1))}).catch(g=>{E(g.message||[])})},p=g=>i(g.target.value),D=g=>l(g.target.value);return y.exports.useEffect(()=>{a&&t("/")},[]),[u("div",{className:"bkg-login"}),c("div",{className:"login-form-block",children:[u(b,{className:"row-login-block",children:u("h2",{className:"title bp3-heading",children:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0438\u044F \u0432 \u0441\u0438\u0441\u0442\u0435\u043C\u0435"})}),u(b,{className:"row-login-block",children:u(r,{children:u(F,{onChange:p,onKeyPress:B,placeholder:"\u041B\u043E\u0433\u0438\u043D",value:o})})}),u(b,{className:"row-login-block",children:u(r,{children:u(F,{type:"password",onChange:D,onKeyPress:B,placeholder:"\u041F\u0430\u0440\u043E\u043B\u044C",value:s})})}),u(b,{className:"row-login-block",children:u(r,{children:u(C,{alignText:"center",className:"success-button",type:"link",onClick:d,children:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u0442\u044C\u0441\u044F"})})}),u(b,{className:"row-login-block",children:(()=>m.map(g=>u(j4,{message:g,type:"error"})))()})]})]};const vu=()=>{O(),P();const t=v(n=>n.main.user);return console.log(t),`${t.person.fam||""}${t.person.im||""}${t.person.otch||""}`,`${t.person.organization.short}`,u(J,{className:"wrapper main-page",children:c(b,{gutter:10,children:[u(r,{span:16}),u(r,{span:8,children:"\u0444\u0432\u044B"})]})})};const zu=()=>{const t=O();return u(b,{children:u(r,{md:24,children:u(K4,{description:"\u0421\u0442\u0440\u0430\u043D\u0438\u0446\u0430 \u043D\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442",children:u(C,{type:"primary",onClick:()=>t("/"),children:"\u041D\u0430 \u0433\u043B\u0430\u0432\u043D\u0443\u044E \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443"})})})})};const Lu={list:[],total:0,pagination:{page:1,limit:10},formOne:{}},$4=n4({name:"orgs",initialState:Lu,reducers:{setOrgsList:(t,n)=>{t.list=[...n.payload.data],t.total=n.payload.count},setOrgsForm:(t,n)=>{t.formOne=M({},n.payload)},setOrgsPagin:(t,n)=>{t.pagination=K(M({},t.pagination),{page:n.payload.page,limit:n.payload.limit})}}}),{setOrgsList:I4,setOrgsForm:j,setOrgsPagin:e4}=$4.actions;var Ou=$4.reducer;const $u=()=>{const{pagename:t,id:n}=R(),a=O(),{list:o,total:i,pagination:s}=v(e=>e.orgs),l=P(),m=e=>{i4(`/organization?id=${e.id}`).then(h=>{w.success(`\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F "${e.name}" \u0443\u0434\u0430\u043B\u0435\u043D\u0430`),D()})},E=[{name:"#",selector:e=>e.id,width:"80px"},{name:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",selector:e=>u(Y,{placement:"topLeft",title:e.name,children:e.name}),width:"200px"},{name:"\u041A\u043E\u0440\u043E\u0442\u043A\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",selector:e=>u(Y,{placement:"topLeft",title:e.short,children:e.short}),width:"200px"},{name:"\u0418\u041D\u041D",selector:e=>e.inn},{name:"\u0414\u0430\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F",selector:e=>$(e.dateCreate).format("DD-MM-YYYY")},{name:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F",cell:e=>c(L,{children:[u(C,{onClick:()=>d(e),type:"primary",ghost:!0,placeholder:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",icon:u(k,{icon:"edit"}),size:"small"}),u(l4,{placement:"leftBottom",trigger:"click",content:c(L,{children:["\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435: ",u(C,{onClick:()=>m(e),size:"small",type:"primary",danger:!0,children:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"})]}),children:u(C,{type:"default",placeholder:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",danger:!0,icon:u(k,{icon:"trash"}),size:"small"})})]}),ignoreRowClick:!0,right:!0}],B=e=>{console.log(e)},d=e=>{e==="new"?(l(j({})),a(`/settings/${t}/new`)):(l(j(e)),a(`/settings/${t}/${e.id}`))},p=()=>D(),D=async e=>{e||w.loading({content:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435...",key:"loading"}),await I("/organization",s).then(h=>{l(I4(h.data)),e||w.success({content:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E",key:"loading"})})},S=(e,h)=>{l(e4({size:h,page:e}))},g=(e,h)=>{l(e4({page:e}))};return y.exports.useEffect(()=>{D(!0)},[s]),c(b,{children:[u(r,{md:24,children:u("div",{className:"wrapper-tab",children:u(T,{title:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438",subTitle:"\u0421\u043F\u0438\u0441\u043E\u043A",ghost:!1,extra:[u(C,{icon:u(k,{icon:"plus"}),type:"primary",ghost:!0,size:"small",onClick:()=>d("new"),children:"\u041D\u043E\u0432\u0430\u044F \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F"}),u(C,{icon:u(k,{icon:"sync"}),type:"primary",ghost:!0,size:"small",onClick:p,children:" "})]})})}),u(r,{md:24,children:u(a4,{size:"small",total:i,showTotal:e=>`\u0412\u0441\u0435\u0433\u043E ${e} \u0437\u0430\u043F\u0438\u0441\u0435\u0439`,defaultPageSize:s.limit,defaultCurrent:s.page,showSizeChanger:!0,onShowSizeChange:S,onChange:g})}),u(r,{md:24,children:u(s4,{columns:E,data:o,selectableRows:!0,onSelectedRowsChange:B,dense:!0})})]})},Iu=()=>{const t=O(),{pagename:n,id:a}=R(),o=a!=="new",[i]=f.useForm(),{formOne:s}=v(S=>S.orgs),l=P(),[m,E]=y.exports.useState(!0),B=()=>t(`/settings/${n}`),d=async S=>{o?await _("/organization",S).then(g=>{w.success("\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B")}):await V("/organization",S).then(g=>{w.success("\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0430"),B()}).catch(g=>{w.error("\u041E\u0448\u0438\u0431\u043A\u0430: "+g.message)})},p=S=>{i.resetFields(),E(!1)},D=async()=>{await I("/organization?filters="+JSON.stringify({id:a})).then(S=>{const g=S.data.data[0];p(),l(j(g||{}))})};return y.exports.useEffect(async()=>{let S=!0;return S&&(A.isEmpty(s)&&o?D():p()),()=>S=!1},[]),c(b,{children:[u(r,{md:24,children:u("div",{className:"wrapper-tab",children:u(T,{title:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F",subTitle:a!=="new"?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435":"\u041D\u043E\u0432\u044B\u0439",onBack:B})})}),m?u(r,{md:24,children:u(H,{active:!0})}):u(r,{md:24,children:c(f,{size:"small",initialValues:s,form:i,name:"form_orgs",className:"ant-advanced-search-form",onFinish:d,labelCol:{span:8},wrapperCol:{span:16},children:[o?u(f.Item,{hidden:!0,name:"id",label:"ID",children:u(F,{})}):null,c(b,{children:[u(r,{md:12,children:c(b,{gutter:12,children:[u(r,{span:24,children:u(f.Item,{name:"name",label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",rules:[{required:!0}],children:u(H4,{})})}),u(r,{span:24,children:u(f.Item,{name:"short",label:"\u0421\u043E\u043A\u0440\u0430\u0449\u0435\u043D\u0438\u0435",rules:[{required:!0}],children:u(F,{})})}),u(r,{span:24,children:u(f.Item,{name:"inn",label:"\u0418\u041D\u041D",rules:[{required:!0}],children:u(Q,{style:{width:"100%"},disabled:o})})}),u(r,{span:24,children:u(f.Item,{name:"ogrn",label:"\u041E\u0413\u0420\u041D",children:u(Q,{style:{width:"100%"},disabled:o})})})]})}),u(r,{md:12,children:c(b,{gutter:12,children:[u(r,{span:24,children:u(f.Item,{name:"address",label:"\u0410\u0434\u0440\u0435\u0441",children:u(F,{})})}),u(r,{span:24,children:u(f.Item,{name:"index",label:"\u0418\u043D\u0434\u0435\u043A\u0441",children:u(Q,{style:{width:"100%"},type:"number"})})})]})}),u(r,{span:24,children:u(G,{})}),u(r,{span:12,children:u(f.Item,{name:"tel",label:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",children:u(Q,{style:{width:"100%"},type:"tel"})})}),u(r,{span:12,children:u(f.Item,{name:"email",label:"\u042D\u043B.\u041F\u043E\u0447\u0442\u0430",children:u(F,{type:"email"})})})]}),u(r,{span:24,children:u(G,{})}),c(r,{span:24,style:{textAlign:"right"},children:[u(C,{type:"primary",htmlType:"submit",children:o?"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"}),u(C,{style:{margin:"0 8px"},onClick:p,children:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F"})]})]})})]})},Nu={list:[],total:0,pagination:{page:1,limit:10},formOne:{}},N4=n4({name:"users",initialState:Nu,reducers:{setUsersList:(t,n)=>{t.list=[...n.payload.data],t.total=n.payload.count},setUsersForm:(t,n)=>{t.formOne=M({},n.payload)},setUsersPagin:(t,n)=>{t.pagination=K(M({},t.pagination),{page:n.payload.page,limit:n.payload.limit})}}}),{setUsersList:Pu,setUsersForm:t4,setUsersPagin:w4}=N4.actions;var Ru=N4.reducer;const Tu=()=>{const{pagename:t,id:n}=R(),a=O(),{list:o,total:i,pagination:s}=v(e=>e.users),l=P(),m=e=>{i4(`/person?id=${e.id}`).then(h=>{w.success("\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u0443\u0434\u0430\u043B\u0435\u043D"),D()}).catch(h=>{w.error("\u041E\u0448\u0438\u0431\u043A\u0430. \u0423\u0434\u0430\u043B\u0438\u0442\u0435 \u0430\u043A\u043A\u0430\u0443\u043D\u0442 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F.")})},E=[{name:"#",selector:e=>e.id,width:"100px"},{name:"\u0424\u0418\u041E",selector:e=>`${e.fam} ${e.im} ${e.otch?e.otch:""}`,grow:2},{name:"\u0414\u0420",selector:e=>e.dateBirth?$(e.dateBirth).format("DD-MM-YYYY"):null},{name:"\u0414\u0430\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F",selector:e=>e.dateCreate?$(e.dateCreate).format("DD-MM-YYYY"):null},{name:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F",cell:e=>c(L,{children:[u(C,{onClick:()=>d(e),type:"primary",ghost:!0,placeholder:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",icon:u(k,{icon:"edit"}),size:"small"}),u(l4,{placement:"leftBottom",trigger:"click",content:c(L,{children:["\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435: ",u(C,{onClick:()=>m(e),size:"small",type:"primary",danger:!0,children:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"})]}),children:u(C,{type:"default",placeholder:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",danger:!0,icon:u(k,{icon:"trash"}),size:"small"})})]}),ignoreRowClick:!0,right:!0}],B=e=>{console.log(e)},d=(e={})=>{let h=M({},e);A.isEmpty(h)?(l(t4({})),a(`/settings/${t}/new`)):(h.dateBirth&&(h.dateBirth=$(h.dateBirth)),l(t4(h)),a(`/settings/${t}/${h.id}`))},p=()=>D(),D=async e=>{e||w.loading({content:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435...",key:"loading"}),await I("/person",s).then(h=>{e||w.success({content:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E",key:"loading"}),l(Pu(h.data))})},S=(e,h)=>{l(w4({size:h,page:e}))},g=(e,h)=>{l(w4({page:e}))};return y.exports.useEffect(()=>{D(!0)},[s]),c(b,{children:[u(r,{md:24,children:u("div",{className:"wrapper-tab",children:u(T,{title:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438",subTitle:"\u0421\u043F\u0438\u0441\u043E\u043A",ghost:!1,extra:[u(C,{icon:u(k,{icon:"plus"}),type:"primary",ghost:!0,size:"small",onClick:()=>d(),children:"\u041D\u043E\u0432\u044B\u0439 \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C"}),u(C,{icon:u(k,{icon:"sync"}),type:"primary",ghost:!0,size:"small",onClick:p,children:" "})]})})}),u(r,{md:24,children:u(a4,{size:"small",total:i,showTotal:e=>`\u0412\u0441\u0435\u0433\u043E ${e} \u0437\u0430\u043F\u0438\u0441\u0435\u0439`,defaultPageSize:s.limit,defaultCurrent:s.page,showSizeChanger:!0,onShowSizeChange:S,onChange:g})}),u(r,{md:24,children:u(s4,{columns:E,data:o,selectableRows:!0,onSelectedRowsChange:B,dense:!0})})]})},S4=[{id:1,name:"\u041C\u0443\u0436\u0441\u043A\u043E\u0439",short:"\u041C"},{id:2,name:"\u0416\u0435\u043D\u0441\u043A\u0438\u0439",short:"\u0416"}],Mu=({accaunt:t})=>{const[n,a]=y.exports.useState([]),[o,i]=y.exports.useState(t.roles),s=()=>{I("/role").then(E=>{a(E.data.data)})},l=E=>{let B=[...o];o.find(d=>d.name===E.name)?B=B.filter(d=>d.name!==E.name):B.push({id:E.id,name:E.name,title:E.title}),i(B)},m=()=>{console.log(t),_(`/accaunt?id=${t.id}`,{roles:o}).then(E=>{w.success("\u0420\u043E\u043B\u0438 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B")})};return y.exports.useEffect(()=>{s()},[]),c(b,{children:[n.map(E=>u(r,{span:24,children:c(g4,{size:"small",children:[u(v4,{checked:o.find(B=>B.name===E.name),onChange:()=>l(E)}),E.name]})},N())),u(r,{span:24,children:u(C,{type:"primary",onClick:m,children:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"})})]})},Yu=()=>{const[t]=f.useForm(),[n,a]=y.exports.useState({}),[o,i]=y.exports.useState(!0),[s,l]=y.exports.useState(!1),{id:m}=R(),E=async d=>{let p={login:d.login,email:d.email,organization:d.organization};l(!0),n.id?await _("/accaunt?id="+n.id,p).then(D=>w.success("\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B")):(p.person=parseInt(m),p.password=d.password,await V("/accaunt",p).then(D=>{D.data.roles=[],a(D.data),w.success("\u0410\u043A\u043A\u0430\u0443\u043D\u0442 \u0441\u043E\u0437\u0434\u0430\u043D")}).catch(D=>w.error("\u041E\u0448\u0438\u0431\u043A\u0430: "+JSON.stringify(D.message)))),t.resetFields(),l(!1)},B=async()=>{await _("/accaunt?id="+n.id,{isActive:!n.isActive}).then(d=>{a(K(M({},n),{isActive:!n.isActive})),t.resetFields(),w.success("\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B")})};return y.exports.useEffect(()=>{m!=="new"&&I("/accaunt?filters="+JSON.stringify({person:m})).then(d=>{let p=d.data.data[0];a(p||{}),i(!1)})},[m]),o?u(r,{md:24,children:u(H,{active:!0})}):c(b,{gutter:8,children:[c(r,{md:18,sm:24,xs:24,children:[c(r,{span:24,children:[u(G,{}),u(X.Title,{level:4,children:"\u0410\u043A\u043A\u0430\u0443\u043D\u0442"})]}),u(f,{size:"small",form:t,initialValues:n,onFinish:E,name:"acc_form_person",labelCol:{span:8},wrapperCol:{span:16},children:c(r,{md:24,children:[u(f.Item,{name:"id",label:"ID",hidden:!0,children:u(F,{hidden:!0})}),u(f.Item,{name:"uid",label:"\u0418\u0434\u0435\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u043E\u0440",children:n.uid?u(p4,{color:"green",children:n.uid}):u(p4,{color:"blue",children:"\u041D\u0435 \u0443\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D"})}),u(f.Item,{name:"email",label:"\u042D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u0430\u044F \u043F\u043E\u0447\u0442\u0430",children:u(F,{type:"email",autoComplete:"new-email"})}),u(f.Item,{name:"login",label:"\u041B\u043E\u0433\u0438\u043D",children:u(F,{autoComplete:"new-login"})}),u(f.Item,{hidden:!!n.uid,name:"password",label:"\u041F\u0430\u0440\u043E\u043B\u044C",children:u(F,{hidden:!!n.uid,autoComplete:"new-password",type:"password"})}),u(C,{type:"primary",htmlType:"submit",loading:s,children:n.uid?"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C":"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0430\u043A\u043A\u0430\u0443\u043D\u0442"}),n.uid?u(L,{children:u(C,{type:"primary",danger:n.isActive,onClick:B,children:n.isActive?"\u0417\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u0442\u044C":"\u0410\u043A\u0442\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C"})}):null]})})]}),c(r,{md:24,sm:24,xs:24,children:[c(r,{span:24,children:[u(G,{}),u(X.Title,{level:4,children:"\u0420\u043E\u043B\u0438"})]}),n.roles?u(Mu,{accaunt:n}):null]})]})},{Search:b4}=F,Vu=({value:t,onChange:n})=>{const[a,o]=y.exports.useState([]),[i,s]=y.exports.useState(0),[l,m]=y.exports.useState(!1),[E,B]=y.exports.useState(!1),[d,p]=y.exports.useState({}),D=()=>m(!0),S=()=>m(!1),g=(x=!1,c4)=>{let z="/organization?filters=";z+=x?JSON.stringify({id:t}):JSON.stringify({name:c4}),I(z).then(U=>{x?p(U.data.data[0]):(o(U.data.data),s(U.data.count)),B(!1)})},e=x=>{B(!0),g(!1,x)},h=x=>{p(x),n(x.id),m(!1)};return y.exports.useEffect(()=>{t&&g(!0)},[t]),c(L,{children:[u(Y,{placement:"bottomLeft",title:d.name,children:u(b4,{onSearch:D,value:d.short,placeholder:"input search loading with enterButton"})}),c(E4,{title:"\u0412\u044B\u0431\u043E\u0440 \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438",visible:l,onCancel:S,footer:!1,children:[u("label",{children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438"}),u(b4,{enterButton:"\u041F\u043E\u0438\u0441\u043A",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438",loading:E,readOnly:E,onSearch:e}),u(g4,{bodyStyle:{height:"240px",overflow:"scroll"},title:`\u041D\u0430\u0439\u0434\u0435\u043D\u043E: ${i}`,children:u(Z,{itemLayout:"horizontal",size:"small",dataSource:a,renderItem:x=>u(Y,{placement:"bottomLeft",title:d.name,children:c(Z.Item,{className:"item-select-dic",onClick:()=>h(x),children:[x.id," - ",x.short]})},N())})})]})]})},{Search:h4}=F,Uu=({value:t,onChange:n,initial:a=!1})=>{const[o,i]=y.exports.useState([]),[s,l]=y.exports.useState(0),[m,E]=y.exports.useState(!1),[B,d]=y.exports.useState(!1),[p,D]=y.exports.useState({}),S=()=>E(!0),g=()=>E(!1),e=(z=!1,U)=>{let f4="/posts?filters=";f4+=z&&t?JSON.stringify({id:t}):JSON.stringify({name:U}),I(f4).then(d4=>{z?D(d4.data.data[0]):(i(d4.data.data),l(d4.data.count)),d(!1)})},h=z=>{d(!0),e(!1,z)},x=z=>{V("/posts",{name:z}).then(U=>{D(U),n(U.id),E(!1)})},c4=z=>{D(z),n(z.id),E(!1)};return y.exports.useEffect(()=>{(t||a)&&e(!!t)},[t,a]),c(L,{children:[u(Y,{placement:"bottomLeft",title:p.name,children:u(h4,{onSearch:S,readOnly:!0,value:p.name,placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u044C"})}),c(E4,{title:"\u0412\u044B\u0431\u043E\u0440 \u0434\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u0438",visible:m,onCancel:g,footer:!1,children:[u("label",{children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0434\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u0438"}),u(h4,{enterButton:"\u041F\u043E\u0438\u0441\u043A",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0434\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u0438",loading:B,readOnly:B,onSearch:h}),u("label",{children:"\u0415\u0441\u043B\u0438 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430, \u0434\u043E\u0431\u0430\u0432\u044C\u0442\u0435 \u0434\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u044C"}),u(h4,{enterButton:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0434\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u0438",onSearch:x}),u(g4,{bodyStyle:{height:"240px",overflow:"scroll"},title:`\u041D\u0430\u0439\u0434\u0435\u043D\u043E: ${s}`,children:u(Z,{itemLayout:"horizontal",size:"small",dataSource:o,renderItem:z=>u(Y,{placement:"bottomLeft",title:p.name,children:c(Z.Item,{className:"item-select-dic",onClick:()=>c4(z),children:[z.id," - ",z.name]})},N())})})]})]})},o4=({type:t,value:n,onChange:a,initial:o})=>{switch(n=A.isObject(n)?n.id:n,t){case"organization":return u(Vu,{value:n,onChange:a,initial:o});case"posts":return u(Uu,{value:n,onChange:a,initial:o})}return"select"},qu=()=>{const t=O(),{pagename:n,id:a}=R(),o=a!=="new",[i]=f.useForm(),{formOne:s}=v(h=>h.users),{user:l}=v(h=>h.main),m=P(),[E,B]=y.exports.useState(!0),[d,p]=y.exports.useState(!1),D=()=>t(`/settings/${n}`),S=async h=>{h.sex&&(h.sexText=A.find(S4,x=>x.id===h.sex).short),h.dateBirth&&(h.dateBirth=$(h.dateBirth).toISOString()),p(!0),o?await _("/person",h).then(x=>{w.success("\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B")}):await V("/person",h).then(x=>{w.success("\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C \u0441\u043E\u0437\u0434\u0430\u043D"),g(),t(`/settings/${n}/${x.id}`)}).catch(x=>{w.error("\u041E\u0448\u0438\u0431\u043A\u0430: "+x.message)}),p(!1)},g=()=>{B(!1)},e=y.exports.useCallback(()=>{I("/person?filters="+JSON.stringify({id:a})).then(h=>{let x=h.data.data[0];x.dateBirth&&(x.dateBirth=$(x.dateBirth)),m(t4(x)),g()})},[a,t4,g,$,m]);return y.exports.useEffect(()=>{let h=!0;return h&&(A.isEmpty(s)&&o?e():g()),()=>{h=!1}}),c(b,{children:[u(r,{md:24,children:u("div",{className:"wrapper-tab",children:u(T,{title:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",subTitle:a!=="new"?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435":"\u041D\u043E\u0432\u044B\u0439",onBack:D})})}),E?u(r,{md:24,children:u(H,{active:!0})}):c(r,{md:24,children:[c(f,{size:"small",initialValues:s,form:i,name:"form_orgs",className:"ant-advanced-search-form",onFinish:S,labelCol:{span:8},wrapperCol:{span:16},children:[o?u(f.Item,{hidden:!0,name:"id",label:"ID",children:u(F,{})}):null,c(b,{children:[c(r,{md:12,sm:24,xs:24,children:[c(b,{gutter:12,children:[u(r,{span:24,children:u(f.Item,{name:"fam",label:"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",rules:[{required:!0}],children:u(F,{})})}),u(r,{span:24,children:u(f.Item,{name:"im",label:"\u0418\u043C\u044F",rules:[{required:!0}],children:u(F,{})})}),u(r,{span:24,children:u(f.Item,{name:"otch",label:"\u041E\u0442\u0447\u0435\u0441\u0442\u0432\u043E",children:u(F,{})})})]}),c(b,{gutter:12,children:[u(r,{span:24,children:u(f.Item,{name:"dateBirth",label:"\u0414\u0430\u0442\u0430 \u0440\u043E\u0436\u0434\u0435\u043D\u0438\u044F",children:u(Q4,{format:"DD-MM-YYYY"})})}),u(r,{span:24,children:u(f.Item,{name:"sex",label:"\u041F\u043E\u043B",children:u(C4,{children:S4.map(h=>u(C4.Option,{value:h.id,children:h.name},N()))})})}),c(r,{span:24,children:[u(G,{}),u(f.Item,{hidden:!Su(l.roles),name:"organization",label:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F",children:u(o4,{type:"organization"})})]})]})]}),u(r,{md:24,sm:24,xs:24,style:{textAlign:"left"},children:u(C,{type:"primary",htmlType:"submit",children:o?"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"})})]})]}),u(Yu,{})]})]})},Ju={list:[],total:0,pagination:{page:1,limit:10},formOne:{}},P4=n4({name:"roles",initialState:Ju,reducers:{setRolesList:(t,n)=>{t.list=[...n.payload.data],t.total=n.payload.count},setRolesForm:(t,n)=>{t.formOne=M({},n.payload)},setRolesPagin:(t,n)=>{t.pagination=K(M({},t.pagination),{page:n.payload.page,limit:n.payload.limit})}}}),{setRolesList:Gu,setRolesForm:F4,setRolesPagin:x4}=P4.actions;var _u=P4.reducer;const k4="role",ju=()=>{const{pagename:t,id:n}=R(),a=O(),{list:o,total:i,pagination:s}=v(e=>e.roles),l=P(),m=e=>{i4(`/${k4}?id=${e.id}`).then(h=>{w.success(`\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F "${e.name}" \u0443\u0434\u0430\u043B\u0435\u043D\u0430`),D()}).catch(h=>{w.error(h.data)})},E=[{name:"#",selector:e=>e.id,width:"50px"},{name:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",selector:e=>e.title,grow:2},{name:"\u041A\u043E\u0434",selector:e=>e.name,grow:2},{name:"\u0414\u0430\u0442\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F",selector:e=>$(e.dateCreate).format("DD-MM-YYYY")},{name:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F",cell:e=>c(L,{children:[u(C,{onClick:()=>d(e),type:"primary",ghost:!0,placeholder:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",icon:u(k,{icon:"edit"}),size:"small"}),u(l4,{placement:"leftBottom",trigger:"click",content:c(L,{children:["\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435: ",u(C,{onClick:()=>m(e),size:"small",type:"primary",danger:!0,children:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"})]}),children:u(C,{type:"default",placeholder:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",danger:!0,icon:u(k,{icon:"trash"}),size:"small"})})]}),ignoreRowClick:!0,right:!0}],B=e=>{console.log(e)},d=e=>{e==="new"?(l(F4({})),a(`/settings/${t}/new`)):(l(F4(e)),a(`/settings/${t}/${e.id}`))},p=()=>D(),D=async e=>{e||w.loading({content:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435...",key:"loading"}),await I(`/${k4}`,s).then(h=>{l(Gu(h.data)),e||w.success({content:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E",key:"loading"})})},S=(e,h)=>{l(x4({size:h,page:e}))},g=(e,h)=>{l(x4({page:e}))};return y.exports.useEffect(()=>{D(!0)},[]),y.exports.useEffect(()=>{D(!0)},[s]),c(b,{children:[u(r,{md:24,children:u("div",{className:"wrapper-tab",children:u(T,{title:"\u0420\u043E\u043B\u0438 \u0438 \u0434\u043E\u0441\u0442\u0443\u043F",subTitle:"\u0421\u043F\u0438\u0441\u043E\u043A",ghost:!1,extra:[u(C,{icon:u(k,{icon:"plus"}),type:"primary",ghost:!0,size:"small",onClick:()=>d("new"),children:" \u0420\u043E\u043B\u044C"}),u(C,{icon:u(k,{icon:"sync"}),type:"primary",ghost:!0,size:"small",onClick:p,children:" "})]})})}),u(r,{md:24,children:u(a4,{size:"small",total:i,showTotal:e=>`\u0412\u0441\u0435\u0433\u043E ${e} \u0437\u0430\u043F\u0438\u0441\u0435\u0439`,defaultPageSize:s.limit,defaultCurrent:s.page,showSizeChanger:!0,onShowSizeChange:S,onChange:g})}),u(r,{md:24,children:u(s4,{columns:E,data:o,selectableRows:!0,onSelectedRowsChange:B,dense:!0})})]})},Ku=()=>{const t=O(),{pagename:n,id:a}=R(),[o]=f.useForm(),[i,s]=y.exports.useState({}),[l,m]=y.exports.useState(!1);y.exports.useState([{id:1,name:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",url:"/role/1",read:!0,create:!1,update:!1,delete:!1}]);const E=()=>t(`/settings/${n}`),B=async d=>{a!=="new"?await _(`/role?id=${a}`,d).then(p=>{w.success("\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B"),m(!1)}).catch(p=>{w.error("\u041E\u0448\u0438\u0431\u043A\u0430: ")}):await V("/role",d).then(p=>{w.success("\u0420\u043E\u043B\u044C \u0441\u043E\u0437\u0434\u0430\u043D"),m(!1),t(`/settings/${n}/${p.id}`)}).catch(p=>{w.error("\u041E\u0448\u0438\u0431\u043A\u0430: "+p.message)})};return y.exports.useEffect(()=>{a!=="new"&&(m(!0),I("/role?filters="+JSON.stringify({id:a})).then(d=>{s(d.data.data[0]),m(!1)}))},[a]),[c(b,{children:[u(r,{md:24,children:u("div",{className:"wrapper-tab",children:u(T,{title:"\u0420\u043E\u043B\u044C",subTitle:a?"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430":"\u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435",onBack:E})})}),c(r,{md:12,xs:24,sm:24,children:[l?u(H,{active:!0}):c(f,{size:"small",initialValues:i,form:o,name:"form_role",className:"ant-advanced-search-form",onFinish:B,labelCol:{span:8},wrapperCol:{span:16},children:[u(f.Item,{name:"title",label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",required:a==="new",children:u(F,{})}),u(f.Item,{name:"name",label:"\u041A\u043E\u0434",required:a==="new",children:u(F,{readOnly:a!=="new"})}),u(C,{type:"primary",htmlType:"submit",children:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"})]}),u(G,{})]})]},"f1")]},Hu=()=>{const{pagename:t,id:n}=R(),a=O(),{list:o,total:i,pagination:s}=v(e=>e.orgs),l=P(),m=e=>{i4(`/otdels?id=${e.id}`).then(h=>{w.success(`\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F "${e.name}" \u0443\u0434\u0430\u043B\u0435\u043D\u0430`),D()})},E=[{name:"#",selector:e=>e.id,width:"80px"},{name:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",selector:e=>u(Y,{placement:"topLeft",title:e.name,children:e.name}),width:"200px"},{name:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F",selector:e=>u(Y,{placement:"topLeft",title:e.organization?e.organization.name:"",children:e.organization?e.organization.name:""}),width:"200px"},{name:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F",cell:e=>c(L,{children:[u(C,{onClick:()=>d(e),type:"primary",ghost:!0,placeholder:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",icon:u(k,{icon:"edit"}),size:"small"}),u(l4,{placement:"leftBottom",trigger:"click",content:c(L,{children:["\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435: ",u(C,{onClick:()=>m(e),size:"small",type:"primary",danger:!0,children:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C"})]}),children:u(C,{type:"default",placeholder:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",danger:!0,icon:u(k,{icon:"trash"}),size:"small"})})]}),ignoreRowClick:!0,right:!0}],B=e=>{console.log(e)},d=e=>{e==="new"?(l(j({})),a(`/settings/${t}/new`)):(l(j(e)),a(`/settings/${t}/${e.id}`))},p=()=>D(),D=async e=>{e||w.loading({content:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435...",key:"loading"}),await I("/otdels",s).then(h=>{l(I4(h.data)),e||w.success({content:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E",key:"loading"})})},S=(e,h)=>{l(e4({size:h,page:e}))},g=(e,h)=>{l(e4({page:e}))};return y.exports.useEffect(()=>{D(!0)},[s]),c(b,{children:[u(r,{md:24,children:u("div",{className:"wrapper-tab",children:u(T,{title:"\u041E\u0442\u0434\u0435\u043B\u044B \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438",subTitle:"\u0421\u043F\u0438\u0441\u043E\u043A",ghost:!1,extra:[u(C,{icon:u(k,{icon:"plus"}),type:"primary",ghost:!0,size:"small",onClick:()=>d("new"),children:"\u041D\u043E\u0432\u044B\u0439 \u043E\u0442\u0434\u0435\u043B"}),u(C,{icon:u(k,{icon:"sync"}),type:"primary",ghost:!0,size:"small",onClick:p,children:" "})]})})}),u(r,{md:24,children:u(a4,{size:"small",total:i,showTotal:e=>`\u0412\u0441\u0435\u0433\u043E ${e} \u0437\u0430\u043F\u0438\u0441\u0435\u0439`,defaultPageSize:s.limit,defaultCurrent:s.page,showSizeChanger:!0,onShowSizeChange:S,onChange:g})}),u(r,{md:24,children:u(s4,{columns:E,data:o,selectableRows:!0,onSelectedRowsChange:B,dense:!0})})]})},Qu=()=>{const t=O(),{pagename:n,id:a}=R(),{user:o}=v(e=>e.main),i=a!=="new",[s]=f.useForm(),{formOne:l}=v(e=>e.orgs),m=P(),[E,B]=y.exports.useState(!0),d=()=>t(`/settings/${n}`),p=async e=>{i?await _("/otdels",e).then(h=>{w.success("\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u044B")}):await V("/otdels",e).then(h=>{w.success("\u041E\u0442\u0434\u0435\u043B \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0430"),d()}).catch(h=>{w.error("\u041E\u0448\u0438\u0431\u043A\u0430: "+h.message)})},D=e=>{s.resetFields(),B(!1)},S=async()=>{await I("/otdels?filters="+JSON.stringify({id:a})).then(e=>{const h=e.data.data[0];D(),m(j(h||{}))})};y.exports.useEffect(async()=>{let e=!0;return e&&(A.isEmpty(l)&&i?S():D()),()=>e=!1},[]);const g=o.roles.some(e=>A.includes("DEVELOP",e.name));return c(b,{children:[u(r,{md:24,children:u("div",{className:"wrapper-tab",children:u(T,{title:"\u041E\u0442\u0434\u0435\u043B",subTitle:a!=="new"?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435":"\u041D\u043E\u0432\u044B\u0439",onBack:d})})}),E?u(r,{md:24,children:u(H,{active:!0})}):u(r,{md:24,children:c(f,{size:"small",initialValues:l,form:s,name:"form_orgs",className:"ant-advanced-search-form",onFinish:p,labelCol:{span:8},wrapperCol:{span:16},children:[i?u(f.Item,{hidden:!0,name:"id",label:"ID",children:u(F,{})}):null,c(b,{children:[u(r,{md:12,children:u(b,{gutter:12,children:u(r,{span:24,children:u(f.Item,{name:"name",label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",rules:[{required:!0}],children:u(F,{})})})})}),g&&u(r,{md:12,children:u(b,{gutter:12,children:u(r,{span:24,children:u(f.Item,{name:"organization",label:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F",required:!0,children:u(o4,{type:"organization"})})})})})]}),u(r,{span:24,children:u(G,{})}),c(r,{span:24,style:{textAlign:"right"},children:[u(C,{type:"primary",htmlType:"submit",children:i?"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"}),u(C,{style:{margin:"0 8px"},onClick:D,children:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F"})]})]})})]})},m4=()=>{const{pagename:t,id:n}=R(),a=O(),{user:o}=v(m=>m.main),i=[{id:1,text:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438",placeholder:"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438",linkto:"users",key:"Users",roles:["ALL"],list:u(Tu,{}),form:u(qu,{})},{id:2,text:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438",placeholder:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438",linkto:"organizations",key:"Organizations",roles:["DEVELOP"],list:u($u,{}),form:u(Iu,{})},{id:3,text:"\u041E\u0442\u0434\u0435\u043B\u044B \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438",placeholder:"\u041E\u0442\u0434\u0435\u043B\u044B \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438",linkto:"otdels",key:"otdels",roles:["ALL"],list:u(Hu,{}),form:u(Qu,{})},{id:10,text:"\u0420\u043E\u043B\u0438 \u0438 \u0434\u043E\u0441\u0442\u0443\u043F",placeholder:"\u0420\u043E\u043B\u0438 \u0438 \u0434\u043E\u0441\u0442\u0443\u043F",linkto:"roles",key:"Roles",roles:["DEVELOP"],list:u(ju,{}),form:u(Ku,{})}],s=m=>{t!==m.key&&a(`/settings/${m.key}`)};y.exports.useEffect(()=>{t||a(`/settings/${i[0].linkto}`)},[]);const l=m=>A.includes(m.roles,"ALL")?!0:o.roles.some(E=>A.includes(m.roles,E.name));return c(J,{className:"wrapper",children:[u(J.Sider,{theme:"light",children:u(W,{onClick:s,selectedKeys:[t],mode:"vertical",children:i.map(m=>l(m)?u(W.Item,{children:m.text},m.linkto):null)})}),u(J.Content,{className:"wrapper",children:(()=>{const m=A.find(i,E=>{if(E.linkto===t)return l(E)?E:null});return m?n?m.form:m.list:null})()})]})},Wu=({list:t=[{}],organization:n,handleUpdPerson:a,id_otdel:o})=>{const i=v(d=>d.main.user),s=d=>{a(o,d)},l=i.roles.some(d=>A.includes("DEVELOP",d.name)),m=i.person.organization.uid===n.uid,E=d=>{console.log(d)};return u(b,{children:u(r,{span:24,children:u(W4,{columns:[{title:"\u0421\u0442\u0430\u0442\u0443\u0441",dataIndex:"id",render:(d,p,D)=>{const S=$();let g;p.dateUpd?g=$.duration(S.diff($(p.dateUpd))):g=$.duration(S.diff($(p.dateCreate)));const e={color:"green",text:"\u0410\u043A\u0442\u0443\u0430\u043B\u044C\u043D\u044B\u0439"};return g.days()>=30&&(e.color="orange",e.text="\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D"),g.days()>=45&&(e.color="error",e.text="\u0423\u0442\u043E\u0447\u043D\u0438\u0442\u044C!"),u(p4,{color:e.color,children:e.text})}},{title:"#",dataIndex:"id",render:(d,p,D)=>D+1},{title:"\u0424\u0418\u041E",dataIndex:"fio",width:"300px",render:(d,p)=>`${p.fam} ${p.im} ${p.otch||""}`},{title:"\u0414\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u044C",dataIndex:"position",render:d=>d.name},{title:"\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u044B\u0439 \u0442\u0435\u043B\u0435\u0444\u043E\u043D",dataIndex:"mobile"},{title:"\u0420\u0430\u0431\u043E\u0447\u0438\u0439 \u0442\u0435\u043B\u0435\u0444\u043E\u043D",dataIndex:"worktel"},{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F",render:d=>l||m?[u(C,{size:"small",icon:u(X4,{}),type:"primary",onClick:()=>s(d)},N()),u(Z4,{placement:"topLeft",title:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435",onConfirm:E(d),okText:"\u0414\u0430",cancelText:"\u041D\u0435\u0442",children:u(C,{size:"small",icon:u(uu,{}),type:"danger"})},N())]:null}],dataSource:t,size:"small",bordered:!0})})})},Xu=({list:t=[],organization:n,setRefresh:a})=>{const[o]=eu.useForm(),i=v(g=>g.main.user),s=i.roles.some(g=>A.includes("DEVELOP",g.name)),l=i.person.organization.uid===n.uid,[m,E]=y.exports.useState(null),[B,d]=y.exports.useState({}),p=()=>{E(null),d({}),o.resetFields()},D=(g,e)=>{d(e),E(g),o.resetFields()},S=()=>{const g=o.getFieldsValue();g.otdel=m,B.id?_("/employes?id="+B.id,g).then(e=>{w.success("\u0421\u043E\u0442\u0440\u0443\u0434\u043D\u0438\u043A \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D"),a(!0),p()}).catch(e=>{w.error("\u041E\u0448\u0438\u0431\u043A\u0430: "+e.message)}):V("/employes",g).then(e=>{w.success("\u0421\u043E\u0442\u0440\u0443\u0434\u043D\u0438\u043A \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D"),a(!0),p()}).catch(e=>{w.error("\u041E\u0448\u0438\u0431\u043A\u0430: "+e.message)})};return c(L,{children:[t.map(g=>c(b,{style:{margin:"0 5px"},justify:"center",children:[c(r,{span:24,children:[u("p",{}),u("span",{style:{marginLeft:"15px",textDecoration:"underline"},children:g.name}),s||l?u(C,{style:{float:"right"},size:"small",type:"primary",onClick:()=>E(g.id),children:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u043E\u0442\u0440\u0443\u0434\u043D\u0438\u043A\u0430"}):null]}),u(r,{span:24,children:u(Wu,{organization:n,list:g.fields,handleUpdPerson:D,id_otdel:g.id})})]},N())),u(E4,{title:"\u0421\u043E\u0442\u0440\u0443\u0434\u043D\u0438\u043A \u043E\u0442\u0434\u0435\u043B\u0430",visible:!!m,onCancel:p,onOk:S,footer:c(L,{children:[u(C,{type:"primary",onClick:S,children:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"}),u(C,{onClick:p,children:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C"})]}),children:u(b,{children:u(r,{span:24,children:c(f,{form:o,initialValues:B,name:"employeeForm",labelCol:{span:8},wrapperCol:{span:16},children:[u(f.Item,{name:"fam",label:"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",required:!0,children:u(F,{})}),u(f.Item,{name:"im",label:"\u0418\u043C\u044F",required:!0,children:u(F,{})}),u(f.Item,{name:"otch",label:"\u041E\u0442\u0447\u0435\u0441\u0442\u0432\u043E",children:u(F,{})}),u(f.Item,{name:"position",label:"\u0414\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u044C",required:!0,children:u(o4,{type:"posts"})}),u(f.Item,{name:"mobile",label:"\u041C\u043E\u0431\u0438\u043B\u044C\u043D\u044B\u0439 \u0442\u0435\u043B\u0435\u0444\u043E\u043D",extra:"\u0412\u0432\u043E\u0434 \u0431\u0435\u0437 \u043A\u043E\u0434\u0430 \u0441\u0442\u0440\u0430\u043D\u044B. \u041F\u0440\u0438\u043C\u0435\u0440: 9133333333",rules:[{pattern:/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/,message:"\u0415\u0441\u0442\u044C \u0441\u0438\u043C\u0432\u043E\u043B\u044B \u043D\u0435 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0435 \u043C\u043E\u0431\u0438\u043B\u044C\u043D\u043E\u043C\u0443 \u043D\u043E\u043C\u0435\u0440\u0443"}],required:!0,children:u(F,{type:"tel",maxLength:10})}),u(f.Item,{name:"worktel",label:"\u0420\u0430\u0431\u043E\u0447\u0438\u0439 \u0442\u0435\u043B\u0435\u0444\u043E\u043D",extra:"\u0412\u0432\u043E\u0434 \u0431\u0435\u0437 \u043A\u043E\u0434\u0430 \u0441\u0442\u0440\u0430\u043D\u044B. \u041F\u0440\u0438\u043C\u0435\u0440: 9133333333",rules:[{pattern:/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/,message:"\u0415\u0441\u0442\u044C \u0441\u0438\u043C\u0432\u043E\u043B\u044B \u043D\u0435 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044E\u0449\u0438\u0435 \u043C\u043E\u0431\u0438\u043B\u044C\u043D\u043E\u043C\u0443 \u043D\u043E\u043C\u0435\u0440\u0443"}],required:!0,children:u(F,{type:"tel",maxLength:10})})]})})})})]})},Zu=({list:t=[],setRefresh:n})=>t.map(a=>{const o=`${a.index||""}, ${a.address||""}, \u0442\u0435\u043B. ${a.tel||""}, \u044D\u043B.\u043F\u043E\u0447\u0442\u0430: ${a.email||""}`;return c(b,{style:{border:"1px solid #caccce",marginBottom:"15px"},children:[c(r,{span:24,style:{backgroundColor:"#2537b714"},children:[u(tu,{level:5,style:{textAlign:"center"},children:a.name}),u("p",{style:{textAlign:"center",color:"#979797"},children:o})]}),u(r,{span:24,children:u(Xu,{list:a.otdels,setRefresh:n,organization:a})})]},N())}),u0=()=>{const[t,n]=y.exports.useState(!0),[a,o]=y.exports.useState([]),[i,s]=y.exports.useState(0),[l]=f.useForm();y.exports.useEffect(()=>{if(t){let p=l.getFieldsValue();p=A.omitBy(p,A.isNil),I("/employes?filters="+JSON.stringify(p)).then(D=>{o(D.data.data[0]),s(D.data.data[1])}).finally(()=>n(!1))}},[t]);const m=p=>{n(!0)},E=()=>{l.resetFields(),n(!0)},B=p=>{const D=l.getFieldsValue();console.log(D),l.setFieldsValue({organization:p.target.value,myorg:void 0})},d=p=>{p&&l.setFieldsValue({organization:void 0,myorg:p})};return c(J,{className:"wrapper",children:[u(X.Title,{level:4}),u(T,{ghost:!1,style:{padding:0},title:"\u0421\u043F\u0440\u0430\u0432\u043E\u0447\u043D\u0438\u043A \u043A\u043E\u043D\u0442\u0430\u043A\u0442\u043E\u0432"}),u(b,{style:{marginBottom:"10px"},children:u(r,{span:24,children:u(B4,{children:u(B4.Panel,{header:"\u0424\u0438\u043B\u044C\u0442\u0440\u044B",children:u(f,{form:l,onFinish:m,name:"filter-form",labelCol:{span:8},wrapperCol:{span:16},size:"small",children:c(b,{gutter:12,children:[u(r,{span:12,children:u(f.Item,{label:"\u041E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F",name:"organization",children:u(F,{onChange:B})})}),u(r,{span:12,children:u(f.Item,{label:"\u041C\u043E\u044F \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u044F",name:"myorg",valuePropName:"checked",children:u(v4,{onChange:d})})}),u(r,{span:12,children:u(f.Item,{label:"\u0424\u0418\u041E",name:"fio",children:u(F,{})})}),u(r,{span:12,children:u(f.Item,{label:"\u0414\u043E\u043B\u0436\u043D\u043E\u0441\u0442\u0438",name:"position",children:u(o4,{type:"posts",initial:!0})})}),c(r,{span:24,children:[u(C,{type:"primary",size:"small",htmlType:"submit",children:"\u041F\u043E\u0438\u0441\u043A"}),u(C,{type:"default",size:"small",onClick:E,children:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C"})]})]})})},"filters")})})}),u(b,{children:u(r,{span:24,children:u(Zu,{list:a,setRefresh:n})})})]})},e0=()=>c(J,{className:"wrapper",children:[u(X.Title,{level:4}),u(T,{ghost:!1,style:{padding:0},title:"\u0421\u0438\u0441\u0442\u0435\u043C\u0430 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0438"})]}),t0=()=>c(z4,{children:[u(q,{path:"/",element:u(vu,{})}),u(q,{path:"/settings",element:u(m4,{})}),u(q,{path:"/settings/:pagename",element:u(m4,{})}),u(q,{path:"/settings/:pagename/:id",element:u(m4,{})}),u(q,{path:"/dictionary",element:u(u0,{})}),u(q,{path:"/tickets",element:u(e0,{})}),u(q,{path:"*",element:u(zu,{})})]});nu.add(au,su,lu,ru,iu,ou,A4,cu);const n0=()=>{const t=O(),{logined:n,loadingGlobal:a}=v(l=>l.main),o=P(),i=du(),s=async()=>{await I("/auth/check").then(l=>{o(u4({status:!0,user:l.data.data})),i.pathname==="/login"&&t("/")}).catch(l=>{o(u4(!1)),t("/login")}).finally(()=>o(O4(!1)))};return y.exports.useEffect(()=>{s()},[]),c(L,{children:[a?u(ku,{}):null,n?u(xu,{children:u(t0,{})}):u(z4,{children:u(q,{path:"login",element:u(Au,{})})})]})},a0=hu({reducer:{main:wu,orgs:Ou,users:Ru,roles:_u},middleware:t=>t({serializableCheck:!1})});$.locale("ru");mu.render(u(pu.StrictMode,{children:u(gu,{children:c(Eu,{store:a0,children:[u(fu,{locale:Du,children:u(n0,{})}),u(yu,{theme:"dark"})]})})}),document.getElementById("root"));
